{% capture line_orig_individual %}{% render 'dla_dm_cart_line_original_individual', dm_rounding: true, dm_orig_line_item: dm_orig_line_item %}{% endcapture %}{% assign line_orig_individual = line_orig_individual | abs %}{% capture cart_orig_total %}{% render 'dla_dm_cart_original_total' %}{% endcapture %}{% assign cart_orig_total = cart_orig_total | abs %}{% assign price = line_orig_individual | times: 0.1 | times: 10 %}{% for discount_allocation in dm_orig_line_item.line_level_discount_allocations %}{% assign discount_application = discount_allocation.discount_application %}{% if discount_application.value_type == 'fixed_amount' %}{% assign discount_value = discount_application.value | times: 100 %}{% else %}{% assign discount_value = discount_application.value | times: 0.1 | times: 10 | times: line_orig_individual | divided_by: 100 %}{% endif %}{% assign price = price | minus: discount_value %}{% endfor %}{% for discount_application in cart.cart_level_discount_applications %}{% if discount_application.value_type == 'fixed_amount' %}{% assign discount_value = discount_application.value | times: 100 %}{% else %}{% assign discount_value = discount_application.value | times: 0.1 | times: 10 | times: cart_orig_total | divided_by: 100 %}{% endif %}{% assign discount_value = discount_value | times: 0.1 | times: 10 | times: line_orig_individual | divided_by: cart_orig_total %}{% assign price = price | minus: discount_value %}{% endfor %}{% if dm_rounding %}{{ price | round }}{% else %}{{ price }}{% endif %}